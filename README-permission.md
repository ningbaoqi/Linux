### Linux的安全性
+ Linux安全系统的核心是用户账户，每个能进入Linux系统的用户都会被分配唯一的用户账户，用户对系统中各种对象的访问权限取决于他们登录系统时用的用户；用户权限是通过创建用户时分配的用户ID（UserID，通常缩写为UID）来跟踪的，UID是数值，每个用户都有唯一的UID；
#### `/etc/passwd`文件
+ Linux系统使用一个专门的文件来将用户的登录名匹配到对应的UID值，这个文件就是`/etc/passwd`它包含了一些与用户有关的信息；root用户账户是Linux系统的管理员，固定分配给它的UID是0；所有运行在后台的服务都需要一个系统用户账户登录到Linux系统上；Linux为系统账户预留了500以下的UID值，有些服务甚至要用特定的UID才能正常工作；普通用户常见账户时，大多数Linux系统从500开始，将第一个可用UID分配给这个账户；

|/etc/passwd文件的字段包含的信息|
|------|
|登录用户名|
|登录密码，都被设置成了 x|
|用户账户的UID|
|用户账户的组ID(GID)|
|用户账户的文本描述|
|用户HOME目录的位置|
|用户默认的shell|

+ `/etc/passwd`文件中的密码字段都被设置成了x，绝大多数Linux系统都将用户密码保存在另一个单独的文件中（叫做shadow文件，位置在`/ect/shadow`）只有特定的程序（如登录程序）才能访问这个文件；

#### `/etc/shadow`文件
+ 只有root用户才能访问/etc/shadow文件，该文件为系统上每个用户账户都保存了一条记录；

|`/etc/shadow`文件的字段含义|
|------|
|与`/etc/passwd`文件中的登录名字段对应的登录名|
|加密后的密码|
|自上次修改密码后过去的天数密码（自1970年1月1日开始计算）|
|多少天后才能更改密码|
|多少天后必须更改密码|
|密码过期前提前多少天提醒用户更改密码|
|密码过期后多少天禁用用户账户|
|用户账户被禁用的日期（用自1970年1月1日到当天的天数表示）|
|预留字段给将来使用|

#### 添加新用户
+ useradd命令使用系统的默认值以及命令行参数来设置用户账户，系统默认值被设置在`/etc/default/useradd`文件中，可以使用加入了-D选项的useradd命令来查看所用Linux系统中的这些默认值：`useradd -D`；在创建新用户时，如果你不在命令行中指定具体的值，useradd命令就会使用-D选项所显示的那些默认值；默认值如下；

|默认值|
|------|------|
|新用户会被添加到GID为100的公共组|
|新用户的HOME目录将会位于/home/loginname|
|新用户账户密码在过期后不会被禁用|
|新用户账户未被设置过期日期|
|新用户账户的默认shell|
|系统会将/etc/skel目录下的内容复制到用户的HOME目录下：/etc/skel目录下的文件是标准启动文件，系统会自动将这些默认文件复制到你创建的每个用户的HOME目录|
|系统没有为该用户账户的mail目录下创建一个用于接受邮件的文件|

+ useradd命令允许管理员创建一份默认的HOME目录配置，其中模版是`/etc/skel`目录下的所有文件；他们是bash shell环境的标准启动文件，系统会自动将这些默认文件复制到你创建的每个用户的HOME目录；必须在root权限下创建用户，可以用默认系统参数创建一个新用户账户，命令如下：`useradd -m  test`；useradd命令不会创建HOME目录，但是-m命令行选项会使其创建HOME目录；

|useradd命令行参数|描述|
|------|------|
|`-c comment `| 给新用户添加备注|
|`-n `| 创建一个与用户登录名同名的新租|
|`-d home_dir`  |为主目录指定一个名字（如果不想用登录名作为主目录名的话）|
|`-M ` |不创建用户的HOME目录（当默认设置里要求创建时才使用这个选项）|
|`-e expire_date`  |用YYYY-MM-DD格式指定一个账户过期的日期|
|`-G group .... ` |指定用户除登录组之外所属的一个或多个附加组|
|`-m ` |创建用户的HOME目录|
|`-g inital_group `| 指定用户登录组的GID或组名|
|`-k`  |必须和-m一起使用，将/etc/skel目录的内容复制到用户的HOME目录|
|`-f inactive_days `| 指定这个账户密码过期后多少天这个账户被禁用，0表示密码一过期就立即禁用，-1表示禁用这个功能|
|`-r` | 创建系统账户|
|`-p passwd` | 为用户账户指定默认密码|
|`-s shell `| 指定默认的登录shell|
|`-u uid` | 为账户指定唯一的UID|

+ 可以使用-D选项后跟上一个指定的值来修改系统默认的新用户设置，这些参数如下：如：`useradd -D -s /bin/tsch`将tsch作为默认登录的shell；

|参数|描述|
|------|------|
|`-b default_home`  |更改默认的创建用户HOME目录的位置|
|`-e expiration_date ` |更改默认的新用户的过期时间|
|`-f inactive ` |更改默认的新用户从密码过期到账户被禁用的天数|
|`-g group`  |更改默认的组名称或GID|
|`-s shell ` |更改默认的登录shell|

#### 删除用户
+ 默认情况下，userdel命令只会删除/etc/passwd文件中的用户信息，而不会删除系统中属于该账户的任何文件；如果加上-r参数，userdel会删除用户的HOME目录以及邮件目录，然而，系统上仍然可能存在已删除用户的其他文件；`userdel -r 用户名`；
#### 修改用户
+ 修改用户账户工具有如下所示；
##### usermod
+ 修改用户账户的字段，还可以制定主要组以及附加组的所属关系； 他能用来修改/etc/passwd文件中的大部分字段。只需用与想修改的字段对应的命令行参数就可以了，参数大部分与useradd命令的参数一样；

|useradd命令的参数选项|描述|
|------|------|
|`-l `|修改用户账户的登录名|
|`-L` |锁定账户，使用户无法登陆|
|`-P`|修改账户密码|
|`-U` |解除锁定，使用户能够登陆|

##### passwd
+ `passwd`用来修改已有用户的密码；`passwd 用户名`；系统上的任何用户都可以该自己的密码，但只有root用户才有权限更改别人的密码；
##### chpasswd  
+ 如果需要为系统中的大量用户修改密码，`chpasswd`命令可以事半功倍，能从标准输入自动读取登录名和密码对（以冒号分割）列表，给密码加密；然后为用户账户设置，也可以重定向命令来将含有`userid：passwd`对的文件重定向给该命令； `chpasswd < users.txt`；
##### chsh
+ `chsh`用来快速修改用户账户的默认登录shell；使用时必须用shell的全路径名作为参数 如：`chsh -s /bin/csh 用户名`；
##### chfn
+ `chfn`修改用户账户的备注信息；该命令提供了在`/etc/passwd`文件的备注字段中存储信息的标准方法；如果在使用chfn命令时没有参数，它会向你询问要将哪些适合的内容加进备注字段 如：`chfn ningbaoqi`；
##### chage
+ `chage`修改密码的过期日期，用来帮助管理用户账户的有效期；

|chage命令参数|描述|
|------|------|
|`-d` | 设置上次修改密码到现在的天数|
|`-E` | 设置密码过期的日期|
|`-I ` |设置密码过期到锁定账户的天数|
|`-m  `|设置修改密码之间最少要多少天|
|`-W ` |设置密码过期前多久开始出现提示信息|

+ chage命令的日期值可以使用以下两种方式中的任意一种；

|日期格式|
|------|
|YYYY-MM-DD格式的日期|
|代表从1970年1月1日起到该日期天数的数值|
